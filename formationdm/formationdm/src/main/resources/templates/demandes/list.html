<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Liste des Demandes de Formation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4e73df;
            --secondary-color: #f8f9fc;
            --accent-color: #2e59d9;
            --text-color: #5a5c69;
            --error-color: #e74a3b;
            --success-color: #1cc88a;
            --warning-color: #f6c23e;
        }

        body {
            background-color: #f8f9fc;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 12px 12px 0 0 !important;
            padding: 1.5rem;
        }

        .badge-en-attente {
            background-color: var(--warning-color);
            color: black;
        }

        .badge-approuvee {
            background-color: var(--success-color);
            color: white;
        }

        .badge-rejetee {
            background-color: var(--error-color);
            color: white;
        }

        .table-hover tbody tr:hover {
            background-color: rgba(78, 115, 223, 0.05);
        }

        .btn-primary {
            background-color: var(--primary-color);
            border: none;
            padding: 0.5rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
        }

        .btn-primary:hover {
            background-color: var(--accent-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .action-btns .btn {
            padding: 0.375rem 0.75rem;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="card">
        <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="mb-0"><i class="fas fa-list-alt me-2"></i>Liste des Demandes de Formation</h2>
                <a th:href="@{/demandes/new}" class="btn btn-light">
                    <i class="fas fa-plus me-1"></i> Nouvelle Demande
                </a>
            </div>
        </div>

        <div class="card-body">
            <!-- Messages d'alerte -->
            <div th:if="${success}" class="alert alert-success alert-dismissible fade show">
                <i class="fas fa-check-circle me-2"></i>
                <span th:text="${success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <div th:if="${error}" class="alert alert-danger alert-dismissible fade show">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span th:text="${error}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Tableau des demandes -->
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Collaborateur</th>
                        <th>Email</th>
                        <th>Formation</th>
                        <th>Date Demande</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="demande : ${demandes}">
                        <td th:text="${demande.id}"></td>
                        <td th:text="${demande.nomCollaborateur}"></td>
                        <td th:text="${demande.emailCollaborateur}"></td>
                        <td>
                            <span th:if="${demande.formation != null}"
                                  th:text="${demande.formation.titre} + ' (' + ${demande.formation.duree} + 'h)'"></span>
                            <span th:unless="${demande.formation != null}" class="text-muted">N/A</span>
                        </td>
                        <td th:text="${demande.formattedDateDemande}"></td>
                        <td>
                            <span th:switch="${demande.statut}" class="badge rounded-pill py-2 px-3">
                                <span th:case="'EN_ATTENTE'" class="badge-en-attente">
                                    <i class="fas fa-clock me-1"></i> En attente
                                </span>
                                <span th:case="'APPROUVEE'" class="badge-approuvee">
                                    <i class="fas fa-check-circle me-1"></i> Approuvée
                                </span>
                                <span th:case="'REJETEE'" class="badge-rejetee">
                                    <i class="fas fa-times-circle me-1"></i> Rejetée
                                </span>
                            </span>
                        </td>
                        <td class="action-btns">
                            <a th:href="@{'/demandes/' + ${demande.id}}" class="btn btn-sm btn-info">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a th:href="@{'/demandes/edit/' + ${demande.id}}" class="btn btn-sm btn-warning">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a th:href="@{'/demandes/delete/' + ${demande.id}}" class="btn btn-sm btn-danger">
                                <i class="fas fa-trash-alt"></i>
                            </a>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(demandes)}">
                        <td colspan="7" class="text-center text-muted py-4">
                            <i class="fas fa-inbox fa-2x mb-2"></i><br>
                            Aucune demande trouvée
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>